import { Meta } from '../components/Meta'
import { IconQuestionMark } from '@tabler/icons-react';
import { Alert, SimpleGrid, Table } from '@mantine/core';
import { Tile, TileValue } from '../components/Tile';
import { ClosedPart, Hand, OpenPart, TileSet } from '../components/Hand';
import { Link } from 'wouter';

<Meta title='Как играть в риичи-маджонг'
      description='Правила игры в риичи-маджонг для начинающих, краткое изложение и полезные ссылки' />

# Как играть в риичи-маджонг

<Link onClick={() => { window.scrollTo({ top: 0, behavior: 'smooth' }); }} to='/yakuList'>Полный список комбинаций</Link>
<br />
<br />

<Alert title="О правилах" color="green">
  Все сведения, данные ниже, являются основной и необходимой базой для успешной игры в риичи-маджонг.
  Существуют вариации правил стола, о которых сказано дополнительно. В данном разделе для каждого русскоязычного термина указаны
  всплывающие пояснения для облегчения понимания. Термины, имеющие такие пояснения, подчеркнуты точечной линией.
</Alert>

## Вступление

Маджонг — игра на четверых человек, берущая свое начало в Китае. Существует множество различных правил игры
в маджонг, в том числе китайские классические, китайские спортивные (MCR), тайваньские, американские.

**Ри́ичи-маджо́нг** — модификация правил,
изобретенная в Японии относительно недавно — во второй половине прошлого века. Риичи-маджонг включает 27 выигрышных комбинаций,
раздельные дискарды игроков, а также исключает использование тайлов цветов и сезонов. В этом разделе рассказывается о базовых
правилах игры в риичи-маджонг, которые необходимо освоить любому начинающему игроку. Описываемые правила основаны на официальных правилах
EMA — европейской ассоциации маджонга. Некоторые популярные отклонения от правил даны в пояснениях.

## Игровой инвентарь

Для игры используются 136 игровых фишек/костей, называемых **тайлами**. Тайлы можно поделить на виды согласно таблице:

**Тайлы мастей:**
<SimpleGrid
  cols={2}
  spacing="0"
  breakpoints={[
    { maxWidth: '60rem', cols: 2 },
    { maxWidth: '42rem', cols: 1 },
  ]}
>
  <div style={{ display: 'flex', alignItems: 'center'}}>Ман (символы) от 1 до 9:</div>
  <Hand><OpenPart>
    <Tile value={TileValue.Man1} />
    <Tile value={TileValue.Man2} />
    <Tile value={TileValue.Man3} />
    <Tile value={TileValue.Man4} />
    <Tile value={TileValue.Man5} />
    <Tile value={TileValue.Man6} />
    <Tile value={TileValue.Man7} />
    <Tile value={TileValue.Man8} />
    <Tile value={TileValue.Man9} />
  </OpenPart></Hand>
  <div style={{ display: 'flex', alignItems: 'center'}}>Пин (точки) от 1 до 9:</div>
  <Hand><OpenPart>
    <Tile value={TileValue.Pin1} />
    <Tile value={TileValue.Pin2} />
    <Tile value={TileValue.Pin3} />
    <Tile value={TileValue.Pin4} />
    <Tile value={TileValue.Pin5} />
    <Tile value={TileValue.Pin6} />
    <Tile value={TileValue.Pin7} />
    <Tile value={TileValue.Pin8} />
    <Tile value={TileValue.Pin9} />
  </OpenPart></Hand>
  <div style={{ display: 'flex', alignItems: 'center'}}>Соу (бамбуки) от 1 до 9:</div>
  <Hand><OpenPart>
    <Tile value={TileValue.Sou1} />
    <Tile value={TileValue.Sou2} />
    <Tile value={TileValue.Sou3} />
    <Tile value={TileValue.Sou4} />
    <Tile value={TileValue.Sou5} />
    <Tile value={TileValue.Sou6} />
    <Tile value={TileValue.Sou7} />
    <Tile value={TileValue.Sou8} />
    <Tile value={TileValue.Sou9} />
  </OpenPart></Hand>
</SimpleGrid>
**Благородные тайлы:**
<SimpleGrid
  cols={2}
  spacing="0"
  breakpoints={[
    { maxWidth: '60rem', cols: 2 },
    { maxWidth: '42rem', cols: 1 },
  ]}
>
  <div style={{ display: 'flex', alignItems: 'center'}}>Ветра (восток-юг-запад-север):</div>
  <Hand><OpenPart>
    <Tile value={TileValue.Ton} />
    <Tile value={TileValue.Nan} />
    <Tile value={TileValue.Sha} />
    <Tile value={TileValue.Pei} />
  </OpenPart></Hand>
  <div style={{ display: 'flex', alignItems: 'center'}}>Драконы (красный-белый-зеленый):</div>
  <Hand><OpenPart>
    <Tile value={TileValue.Chun} />
    <Tile value={TileValue.Haku} />
    <Tile value={TileValue.Hatsu} />
  </OpenPart></Hand>
</SimpleGrid>

Единицы и девятки тайлов мастей называются **терминальными тайлами**. Тайлы мастей от 2 до 8 включительно
называются **простыми тайлами**. Каждого тайла в игре **ровно 4 штуки**. Всего видов тайлов — 34. Полный
набор = 34 × 4 = 136 тайлов.

Для подсчета очков используются счетные палочки:
<Table>
  <tbody>
    <tr>
      <td>10000 очков:</td>
      <td><img src="/assets/img/10000.avif" alt="" /></td>
    </tr>
    <tr>
      <td>5000 очков:</td>
      <td><img src="/assets/img/5000.avif" alt="" /></td>
    </tr>
    <tr>
      <td>1000 очков:</td>
      <td><img src="/assets/img/1000.avif" alt="" /></td>
    </tr>
    <tr>
      <td>100 очков:</td>
      <td><img src="/assets/img/100.jpg" alt="" /></td>
    </tr>
  </tbody>
</Table>

Каждому игроку в начале игры выдается базовое количество очков в размерах 30000. Обычно это одна палочка на
10000, две на 5000, девять на 1000 и десять на 100 очков. Иногда могут встречаться палочки по 500 очков, чаще
всего они имеют зеленый цвет и имеют 8 точек, аналогично палочкам по 100 очков.

**Цель игры** — выиграть наибольшее количество очков. Очков в игре фиксированное количество, поэтому выиграть
очки можно только получив их от другого игрока. Таким образом, в риичи-маджонге важно не только выигрывать
очки, но и не проигрывать их.

Также в игре используются:
- Два шестигранных кубика
- Индикатор дилера — пластинка, на которой с двух сторон нанесены изображения восточного и южного ветров.

## Ход игры

Игровая партия состоит из раундов, называемых по сторонам света. Партия, состоящая из восточных и южных раундов,
называется **ханча́н**; партия, состоящая только из восточных раундов, называется **тонпуусе́н**. О том, какие
раунды играются, оговаривается явно в правилах стола, однако если это явно не указано, предполагается, что играется
ханчан.

Согласно правилам EMA, возможно уходить в минус по очкам. Для расчетов в этом случае используются особые черные палочки,
обозначающие -10000, -5000, -1000 очков соответственно.

<Alert color="green">
  Существуют вариации правил, при которой в случае, если у кого-либо из игроков не остается очков, игра прерывается досрочно.
</Alert>

Игра начинается с определения первого **дилера** — игрока, который начинает раздачу. Существует несколько способов определения дилера,
рассмотрим самые распространенные:
- На стол кладется четыре тайла различных ветров рубашкой вверх. Игроки вытягивают ветра, дилером становится игрок,
  вытянувший восточный ветер. Справа от него садится игрок, вытянувший юг, напротив — запад, слева — север. Этот
  способ соответствует описанному в правилах EMA.
- Каждый игрок бросает кубики один раз. Дилером становится игрок, у которого выпало наибольшее число на кубиках.
  Перераспределения игроков по местам относительно дилера в этом способе не происходит.
- Также при использовании электронного ассистента распределение игроков за столом происходит либо автоматически, либо
  нажатием на соответствующую кнопку.

После указанных действий дилер кладет рядом с собой индикатор первого дилера — пластинку, на которой изображен восточный
ветер с одной стороны и южный с другой. Пластинка кладется так, чтобы сверху был восточный ветер — этот ветер будет
являться текущим **ветром раунда**. Когда в игре начинаются южные раунды, пластинка переворачивается.

### Подготовка к раздаче

Перед началом каждой раздачи игроки выкладывают тайлы на стол рубашкой вверх и тщательно их перемешивают. После этого
игроки выстраивают на столе квадратную **стену** из тайлов, каждая сторона которой должна быть 17 тайлов в длину и 2
тайла в высоту:
<div style={{ textAlign: 'center' }}>
  <img src="/assets/img/wall.avif" style={{ width: '100%', maxWidth: '600px' }} alt="" />
</div>

Дилер бросает кубики один раз и отсчитывает выпавшее на кубиках число **против часовой стрелки**, начиная с себя
(см. схему):
<div style={{ textAlign: 'center' }}>
  <img src="/assets/img/wall-break.avif" style={{ width: '100%', maxWidth: '400px' }} alt="" />
</div>

За каждым игроком закрепляются собственные ветра согласно схеме. Ветер, закрепленный за игроком, называется его
**ветром места**. Дилер всегда сидит на восточном ветре. Игрок, на которого укажет дилер
(в примере это игрок северного ветра), отсчитывает в своей части стены, начиная с правого края,
**то же самое выпавшее число** и разделяет стену так, чтобы справа от разлома было
число пар тайлов, соответствующее числу, выпавшему на кубиках, а слева — оставшаяся часть.
<div style={{ textAlign: 'center' }}>
  <img src="/assets/img/wall-break-2.avif" style={{ width: '100%', maxWidth: '600px' }} alt="" />
</div>

Разбор стены происходит **по часовой стрелке**, начиная от разлома. Стена считается непрерывной и круговой, после
окончания разбора одной стороны стены начинается разбор следующей ее стороны по часовой стрелке. Первый и последний
тайлы стены указаны на рисунке. 7 пар тайлов с конца стены отделяются от основной стены, образуя **мертвую стену**.
Эти 14 тайлов в разборе не участвуют, т.е. разбор стены оканчивается тогда, когда на столе не остается ни одного
тайла из основной стены. В мертвой стене третий тайл слева переворачивается. При этом получается следующая картина:
<div style={{ textAlign: 'center' }}>
  <img src="/assets/img/wall-break-3.avif" style={{ width: '100%', maxWidth: '600px' }} alt="" />
</div>

<Alert color="green">
  Отделять 14 тайлов мертвой стены в самом начале игры — не обязательное требование. Более того, на турнирах
  игроки могут потребовать не трогать стены лишний раз. Отделить 14 тайлов мертвой стены от живой в этом случае
  лучше всего ближе к окончанию разбора стены.
</Alert>

Далее начинается первичный разбор стены (разбор идет также **по часовой стрелке**). Начиная с дилера и с
последовательностью хода **против часовой стрелки** каждый игрок берет себе три раза по 4 тайла (стопку 2х2).
После этого каждый берет 1 раз по одному тайлу (в последовательности сначала верхний, затем нижний), и наконец
дилер берет себе еще один тайл. На этом первоначальный разбор завершен. Взятые тайлы игроки выставляют на стол
перед собой так, чтобы сам игрок видел значащие рисунки на тайлах, а его оппоненты видели только рубашки его
тайлов. Набор тайлов у игрока называют его **рукой**. У дилера на руке изначально 14 тайлов, у остальных — по
13 тайлов.

<Alert color="green">
  Дилер всегда берет первый тайл со стены после разбора, поэтому для ускорения процесса он может просто после взятия
  первых трех стопок забрать первый и третий тайлы из верхнего ряда стены.
</Alert>

### Ход раздачи

Ход игры состоит в последовательной замене тайлов в руке на другие тайлы, приходящие со стены. В порядке хода
(против часовой стрелки) игроки берут со стены один тайл, после чего выбирают в своей руке самый ненужный тайл и сносят
его в **дискард** — специальное место в центре стола. Дискард складывается слева направо, по 6 тайлов в ряд, в три ряда.
Четвертый ряд обычно не начинают и при необходимости выкладывают седьмой и восьмой тайлы в третий ряд. На своем ходу
игрок **обязан** взять один тайл (со стены либо <abbr title="через объявление открытых сетов, см. далее">с дискарда другого игрока</abbr>)
и сбросить один тайл в дискард (за исключением случая, когда взятый со стены тайл приносит игроку победу — в этом случае
раздача заканчивается). Тайлы, лежащие в дискарде, не участвуют в игре и с них нельзя сделать
<abbr title="объявление победы или открытого сета, см. далее">объявлений</abbr>. Любые объявления можно делать
исключительно с тайла, который на данный момент сбрасывается в дискард (т.е. до тех пор, пока следующий игрок еще не взял
следующий тайл со стены). Главной целью является сбор в руке сочетаний тайлов — **сетов**. В руке
необходимо собрать **четыре сета и одну пару**. Сет может быть трех видов:

- Три одинаковых тайла — **ко́цу** (далее для простоты будем называть этот сет "пон", аналогично объявлению),
- Три последовательных тайла — **шу́нцу**, например 2-3-4, при этом последовательности можно собирать **только из тайлов мастей** (далее для простоты будем называть этот сет "чи", аналогично объявлению),
- Четыре одинаковых тайла — **ка́нцу** (далее для простоты будем называть этот сет "кан", аналогично объявлению).

Пара, которая также обязана быть в руке, называется **атама** (или **то́йцу**) (далее для простоты будем называть ее просто "парой").

### Объявления открытых сетов

Для ускорения сбора руки путем получения тайлов из чужого дискарда можно использовать **объявления**. В случае, если
в руке есть два одинаковых тайла и кто-то сбрасывает третий, в этот момент можно громко сказать "**Пон**", после чего
вскрыть пару своих тайлов, положить справа от руки, взять тайл из чужого дискарда и дополнить им пару так, чтобы
получился сет. Игрок, взявший пон, должен сбросить лишний тайл, поскольку его рука должна вернуться к ожидающему
состоянию. После этого ход переходит к игроку, следующему по направлению хода за игроком, взявшим пон. Пон можно
взять с любого игрока, но только в момент его сброса. Взятый тайл кладется **боком** так, чтобы было понятно, с
какого игрока был взят пон:
<Hand>
  <ClosedPart>
    <TileSet>
      <Tile value={TileValue.Pin5} />
      <Tile value={TileValue.Pin6} />
      <Tile value={TileValue.Pin7} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Man8} />
    </TileSet>
  </ClosedPart>
  <OpenPart>
    <TileSet>
      <Tile value={TileValue.Haku} rotated/>
      <Tile value={TileValue.Haku} />
      <Tile value={TileValue.Haku} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Pin8} />
      <Tile value={TileValue.Pin8} rotated/>
      <Tile value={TileValue.Pin8} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Sou2} />
      <Tile value={TileValue.Sou2} />
      <Tile value={TileValue.Sou2} rotated/>
    </TileSet>
  </OpenPart>
</Hand>

В примере выше белый дракон был взят с игрока слева, 8 <abbr title="точек">пин</abbr> была взята с игрока напротив,
а 2 <abbr title="бамбуков">соу</abbr> — с игрока справа.

<Alert color="green">
  Будьте внимательны в последовательности выполнения объявления, особенно на турнирах — это важно. Придерживайтесь
  следующей последовательности:
  — Громкое объявление
  — Вскрытие тайлов из руки
  — Дополнение сета тайлом из дискарда
</Alert>

Если в руке есть два последовательных тайла и игрок слева сбрасывает в дискард третий, дополняющий эти тайлы до чи,
в этот момент можно громко сказать "**Чи**", после чего вскрыть пару последовательных тайлов, положить их справа
от руки, взять тайл из чужого дискарда и дополнить им тайлы так, чтобы получился сет. Игрок, взявший чи, должен
сбросить лишний тайл, поскольку его рука должна вернуться к ожидающему состоянию. После этого ход переходит к
игроку, следующему по направлению хода за игроком, взявшим чи. После взятия чи нельзя сбросить такой же тайл,
какой был взят из чужого дискарда, либо тайл, дополнявший последовательность до закрытого чи до его взятия.

<Alert color="green">
  Существуют вариации правил, в которых все же допускается такой "сдвиг" чи или безопасный сброс такого же тайла. Это
  правило стола называется "Куикаэ".
</Alert>

Чи можно взять **только с игрока слева**. Тем не менее, взятый тайл кладется так, чтобы было понятно, что
он взят с игрока слева:
<Hand>
  <ClosedPart>
    <TileSet>
      <Tile value={TileValue.Man8} />
      <Tile value={TileValue.Man8} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Pin8} />
      <Tile value={TileValue.Pin8} />
      <Tile value={TileValue.Pin8} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Sou3} />
      <Tile value={TileValue.Sou4} />
    </TileSet>
  </ClosedPart>
  <OpenPart>
    <TileSet>
      <Tile value={TileValue.Pin6} rotated/>
      <Tile value={TileValue.Pin5} />
      <Tile value={TileValue.Pin7} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Haku} rotated />
      <Tile value={TileValue.Haku} />
      <Tile value={TileValue.Haku} />
    </TileSet>
  </OpenPart>
</Hand>

В случае, если два игрока одновременно сказали "чи" и "пон" на один и тот же тайл, приоритет имеет игрок, сказавший "пон".
Рука, в которой есть открытые сеты, называется **открытой**. В большинстве случаев открытая рука стоит дешевле закрытой,
кроме того иногда с открытой рукой победить <abbr title="Это происходит, если в руке нет яку — см. ниже про яку">просто нельзя</abbr>.
Модифицировать открытые части руки **нельзя**, т.е. запрещено осуществлять сброс и замену тайлов, которые находятся в
открытых сетах.

**Канцу**  или кан — особая форма, состоящая из четырех одинаковых тайлов. Кан считается за один сет, но только в том
случае, если он объявлен. В примере ниже кан не существует, поскольку он не объявлен:
<Hand>
  <ClosedPart>
    <TileSet>
      <Tile value={TileValue.Man8} />
      <Tile value={TileValue.Man8} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Pin4} />
      <Tile value={TileValue.Pin4} />
      <Tile value={TileValue.Pin4} />
      <Tile value={TileValue.Pin4} />
      <Tile value={TileValue.Pin5} />
      <Tile value={TileValue.Pin6} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Sou2} />
      <Tile value={TileValue.Sou3} />
      <Tile value={TileValue.Sou4} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Ton} />
      <Tile value={TileValue.Ton} />
    </TileSet>
  </ClosedPart>
</Hand>

Кан может получиться в руке тремя способами. Оговорим отдельно каждый из них. Допустим, у нас есть указанная выше
рука и мы хотим объявить кан четверок <abbr title="точек">пин</abbr>. Для этого на своем ходу после взятия со стены мы
громко говорим "**Кан**", после чего вскрываем все четыре тайла. Крайние два тайла с каждой стороны переворачиваем
рубашкой вверх и выкладываем их справа от руки. Такая форма называется **анкан** или закрытый кан. Несмотря на то, что
этот кан выложен отдельно, рука, содержащая **только** закрытый кан, считается закрытой. В мертвой стене открывается
новый верхний тайл, следующий за тайлом, открытым в самом начале раздачи (четвертый от края мертвой стены). Далее,
поскольку теперь в руке игрока недостаточно тайлов, он должен взять **риншанпай** — тайл замены из мертвой
стены, это тайл с самого края стены. После этого игрок совершает обычный сброс тайла в дискард и ход переходит дальше.
Рука игрока после совершения описанных действий станет выглядеть следующим образом:
<Hand>
  <ClosedPart>
    <TileSet>
      <Tile value={TileValue.Man8} />
      <Tile value={TileValue.Man8} />
      <Tile value={TileValue.Man9} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Pin5} />
      <Tile value={TileValue.Pin6} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Sou2} />
      <Tile value={TileValue.Sou3} />
      <Tile value={TileValue.Sou4} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Ton} />
      <Tile value={TileValue.Ton} />
    </TileSet>
  </ClosedPart>
  <OpenPart>
    <TileSet>
      <Tile value={TileValue.Closed}/>
      <Tile value={TileValue.Pin4} />
      <Tile value={TileValue.Pin4} />
      <Tile value={TileValue.Closed} />
    </TileSet>
  </OpenPart>
</Hand>

Второй способ получения кана — путем объявления. В случае, если в руке есть закрытый пон,
а кто-либо сбрасывает четвертый тайл, можно громко сказать "Кан", после чего вскрыть три тайла закрытого пона,
положить их справа от руки и дополнить взятым тайлом из чужого дискарда.
<Hand>
  <ClosedPart>
    <TileSet>
      <Tile value={TileValue.Pin5} />
      <Tile value={TileValue.Pin6} />
      <Tile value={TileValue.Pin7} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Man8} />
    </TileSet>
  </ClosedPart>
  <OpenPart>
    <TileSet>
      <Tile value={TileValue.Haku} rotated />
      <Tile value={TileValue.Haku} />
      <Tile value={TileValue.Haku} />
      <Tile value={TileValue.Haku} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Pin8} />
      <Tile value={TileValue.Pin8} rotated />
      <Tile value={TileValue.Pin8} />
      <Tile value={TileValue.Pin8} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Sou2} />
      <Tile value={TileValue.Sou2} />
      <Tile value={TileValue.Sou2} />
      <Tile value={TileValue.Sou2} rotated />
    </TileSet>
  </OpenPart>
</Hand>

В примере выше белый дракон был взят с игрока слева, 8 <abbr title="точек">пин</abbr> была взята с игрока напротив, а
2 <abbr title="бамбуков">соу</abbr> — с игрока справа. После взятия кана точно так же требуется взять
риншанпай и совершить сброс в дискард, после чего открыть новый верхний тайл в мертвой стене.

<Alert color="green">
  В некоторых вариациях правил новый верхний тайл в мертвой стене открывается не сразу после объявления, а сразу
  после сброса игрока, объявившего кан, но до любых объявлений со сброшенного тайла. Это работает только для открытых
  канов.
</Alert>

Третий и последний способ получения кана заключается в возможности дополнения открытого пона до кана. Это можно сделать
в том случае, если у игрока открыт пон и **со стены** заходит последний четвертый тайл. В этом случае игрок вправе громко
сказать "Кан" и доложить взятый тайл к пону, после чего взять риншанпай и совершить сброс в дискард.
Точно так же после объявления открывается новый верхний тайл в мертвой стене. Рука после объявления доложенного кана может
выглядеть следующим образом:
<Hand>
  <ClosedPart>
    <TileSet>
      <Tile value={TileValue.Pin5} />
      <Tile value={TileValue.Pin6} />
      <Tile value={TileValue.Pin7} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Man8} />
    </TileSet>
  </ClosedPart>
  <OpenPart>
    <TileSet>
      <Tile value={TileValue.Haku} rotated shominkan />
      <Tile value={TileValue.Haku} />
      <Tile value={TileValue.Haku} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Pin8} />
      <Tile value={TileValue.Pin8} rotated shominkan />
      <Tile value={TileValue.Pin8} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Sou2} />
      <Tile value={TileValue.Sou2} />
      <Tile value={TileValue.Sou2} rotated shominkan />
    </TileSet>
  </OpenPart>
</Hand>
Непосредственно после того, как был доложен кан, и до того, как игрок взял риншанпай, любой другой игрок вправе
объявить победу (**чанкан**) с доложенного тайла, если его ожидание включает этот тайл. Чи, пон и кан
**не могут быть объявлены** на последнем сброшенном тайле в раздаче.

В случае, если на столе открыто 4 кана, никто из игроков не имеет права объявить пятый кан.

<Alert color="green">
  В некоторых вариация правил если в игре объявлено 4 кана и после сброса на четвертом кане никто не выиграл,
  объявляется досрочная пересдача. При пересдаче игроки не обязаны показывать свои руки, тайлы просто замешиваются,
  строится новая стена и начинается новая раздача.
</Alert>

В руке может быть открыто до четырех сетов включительно (т.е. может остаться ожидание в пару на единственный закрытый тайл).
При открытии нескольких сетов придерживайтесь принципа их расположения в углу стола **либо справа налево, либо снизу вверх**,
т.к. в игре может быть важна последовательность выполнения объявлений.

### Объявление победы, ничья и пересдача

**Выигрышная рука** состоит из четырех сетов и пары; первая из двух основных целей игры — собрать выигрышную руку.
**Ожидающая рука** — рука, которой не хватает одного тайла до победы. Состояние игрока, у которого рука ожидающая,
называется **темпай**. В игре победа всегда объявляется игроком с ожидающей рукой с дополнительного тайла.
Дополнительный тайл для победы может быть получен двумя способами:
- Тайл может быть взят со стены. Эта ситуация называется **цумо́**,
- Тайл может быть взят с дискарда кого-либо из игроков. Эта ситуация называется **рон**.

При победе по рон, игрок, с дискарда которого была объявлена победа, единолично выплачивает победившему игроку
некоторую сумму очков. Если на один и тот же тайл
были сделаны объявления "чи", "пон"/"кан" и "рон", приоритет имеет объявление победы. Последовательность действий игрока
при победе по рон:
- При появлении в дискарде выигрышного тайла, громко вслух сказать "Рон".
- Опционально, взять выигрышный тайл из чужого дискарда и положить его **справа от руки**, но при этом недопустимо встраивать
  выигрышный тайл в руку — он должен явно лежать отдельно.
- Полностью открыть свою руку, чтобы остальные игроки могли проверить факт победы.
- Огласить количество очков, в которое оценивается рука.

<Alert color="green">
  На турнирах обычно требуется, чтобы игроки не трогали чужие дискарды (т.е. второй пункт выполнять не следует).
  Кроме того, это позволяет явно определить с кого из игроков была произведена победа.
</Alert>

При победе по цумо, победившему игроку платят все остальные игроки за столом. Последовательность действий точно такая
же, за тем исключением, что тайл берется из стены, а не с чужого дискарда и при этом громко вслух говорится "Цумо".
Выигрышный тайл в этом случае всегда кладется справа от руки, но встраивание его в руку недопустимо.

В случае, если никто из игроков не объявил победу до того момента, как стена оказалась полностью разобрана, объявляется
**ничья**. При ничьей темпай-игроки открывают свои руки, чтобы остальные игроки могли проверить их темпай, после чего
<abbr title="не являющиеся темпай">нотен</abbr>-игроки выплачивают темпай-игрокам штраф. Общая сумма выплат по ничьей
фиксирована и всегда равна **3000**. Таким образом, если 1 игрок темпай, то каждый из остальных игроков платит ему по
1000, если 2 игрока темпай, то оставшиеся 2 игрока платят им по 1500 каждый, а если 3 игрока темпай, то оставшийся
игрок платит каждому по 1000. Если все игроки темпай или все игроки <abbr title="не являющиеся темпай">нотен</abbr>,
выплат по ничьей не производится. В случае, если победил дилер, либо при ничьей дилер остался темпай, назначается
**ренчан** — дополнительная раздача. За каждый ренчан в правом углу стола относительно текущего дилера кладется
одна палочка номиналом в 100 очков, которая называется **хонба**. В победах в каждой последующей раздаче за
каждую хонбу к основной сумме выплат добавляется 300 очков. В случае победы по рон, выплаты по хонбе ложатся на
проигравшего игрока, в случае же цумо выплаты делятся поровну между оставшимися тремя игроками.

При победе игрока, не являющегося дилером, **хонба сбрасывается до нуля** и дилерство переходит следующему игроку
по направлению хода (против часовой стрелки). После броска кубиков для новой раздачи дилер обязан убрать кубики в свою
сторону, чтобы все игроки могли видеть, кто в текущей раздаче является дилером. В случае, если при ничьей дилер
остался <abbr title="не являющийся темпай">нотен</abbr>, дилерство также переходит по направлению хода, но
**хонба не сбрасывается**, а увеличивается на 1.

<Alert color="green">
  Индикаторы хонбы берутся из очков текущего дилера. Будьте внимательны — в описанном случае предыдущий дилер должен
  забрать индикаторы себе (поскольку это его очки), а новый дилер должен выложить столько же индикаторов плюс один.
</Alert>

Когда каждый игрок побывал дилером по одному разу (неважно сколько ренчанов при этом состоялось), при следующей
смене дилера индикатор переворачивается и начинаются южные раунды. Когда каждый игрок побывал дилером в южных
раундах, игра завершается и подсчитываются очки.

<Alert color="green">
  В правилах EMA пересдачи отсутствуют полностью. В случае, если правилами вашего стола предусматриваются пересдачи,
  они назначаются в следующих случаях:
  — Если в первом круге сдачи все игроки сбросили тайлы одного ветра.
  — Игрок может объявить пересдачу при своём первом взятии со стены, если у него на руке есть минимум девять разных
    терминальных или благородных тайлов. При этом до его хода никто не должен был объявлять чи, пон или кан. Эта
    пересдача носит название **кюсюкюхай**.
  — После объявления четвертого кана. Пересдача происходит, если каны принадлежат разным игрокам, а в момент объявления
    четвертого кана никто не объявил победу. Однако, если один человек объявил четыре кана, то игра продолжается, но
    остальные игроки не могут объявить пятый кан.
  — Победа троих. Ситуация,  когда три игрока объявляют победу на одном и том же тайле, сброшенным четвёртым игроком.
  — Четыре <abbr title="про риичи рассказано далее">риичи</abbr>. Происходит при объявлении
    четвертого риичи, если никто не объявил рон на сброшенный тайл.

  Пересдача считается ренчаном (докладывается счетчик хонбы).
</Alert>

### Яку и хан
Наличие выигрышной руки является необходимым, но не достаточным условием возможности объявления победы. Вторым условием,
которое должно быть выполнено, является наличие в руке игрока как минимум одного **яку** — особого ценного условия.
Полный список яку можно посмотреть на
<Link onClick={() => { window.scrollTo({ top: 0, behavior: 'smooth' }); }} to='/yakuList'>странице со списком яку</Link>,
здесь же мы ограничимся
рассмотрением комбинационных яку и риичи.

Яку измеримы и некоторые яку дороже других. Стоимость яку измеряют в единицах, которые называются **хан**.
Рассмотрим одно из самых популярных яку — **якуха́й**.

Якухай — пон или кан тайлов драконов, ветров места или ветров раунда. Якухай стоит 1 хан. Если собран якухай ветра
раунда, который одновременно является ветром места, такой якухай является двойным и стоит соответственно 2 хан.
Пример выигрышной руки, в которой собран якухай зеленых драконов:
<Hand>
  <ClosedPart>
    <TileSet>
      <Tile value={TileValue.Pin5} />
      <Tile value={TileValue.Pin6} />
      <Tile value={TileValue.Pin7} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Sou1} />
      <Tile value={TileValue.Sou2} />
      <Tile value={TileValue.Sou3} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Pin9} />
      <Tile value={TileValue.Pin9} />
    </TileSet>
  </ClosedPart>
  <OpenPart>
    <TileSet>
      <Tile value={TileValue.Hatsu} rotated/>
      <Tile value={TileValue.Hatsu} />
      <Tile value={TileValue.Hatsu} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Man8} />
      <Tile value={TileValue.Man8} rotated />
      <Tile value={TileValue.Man8} />
    </TileSet>
  </OpenPart>
</Hand>

В руке может быть собрано более одного якухая, в этом случае их стоимость суммируется. Обычно якухай — самая
распространенная причина раннего открытия руки.

Есть несколько яку, которые **работают только на закрытой руке**, также есть несколько яку, стоимость которых
на открытой руке меньше, чем стоимость на закрытой. Пример:
  <Hand>
    <ClosedPart>
      <TileSet>
        <Tile value={TileValue.Pin5} />
        <Tile value={TileValue.Pin6} />
        <Tile value={TileValue.Pin7} />
      </TileSet>
      <TileSet>
        <Tile value={TileValue.Sou1} />
        <Tile value={TileValue.Sou2} />
        <Tile value={TileValue.Sou3} />
      </TileSet>
      <TileSet>
        <Tile value={TileValue.Pin9} />
        <Tile value={TileValue.Pin9} />
      </TileSet>
      <TileSet>
        <Tile value={TileValue.Pin5} />
        <Tile value={TileValue.Pin6} />
        <Tile value={TileValue.Pin7} />
      </TileSet>
      <TileSet>
        <Tile value={TileValue.Man7} />
        <Tile value={TileValue.Man8} />
        <Tile value={TileValue.Man9} />
      </TileSet>
    </ClosedPart>
  </Hand>

В данной руке есть яку **иипе́йко**, которое заключается в том, что в руке есть два одинаковых
чи. Иипейко работает **только на закрытой руке**.

Бывает такое, что при закрытой руке никак не складывается никакое яку, и нет даже намека на победу. Возьмем
например следующую руку:
<Hand>
  <ClosedPart>
    <TileSet>
      <Tile value={TileValue.Pin5} />
      <Tile value={TileValue.Pin6} />
      <Tile value={TileValue.Pin7} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Sou1} />
      <Tile value={TileValue.Sou2} />
      <Tile value={TileValue.Sou3} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Pin9} />
      <Tile value={TileValue.Pin9} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Sou4} />
      <Tile value={TileValue.Sou5} />
      <Tile value={TileValue.Sou6} />
    </TileSet>
    <TileSet>
      <Tile value={TileValue.Man8} />
      <Tile value={TileValue.Man9} />
    </TileSet>
  </ClosedPart>
</Hand>

Эта рука является ожидающей, но в ней не только нет ни одного яку, но нет и никакой перспективы это яку
получить в процессе модификации. И в этом случае к нам приходит на помощь особое яку японского маджонга,
из-за которого он и получил свое название — **ри́ичи**. Риичи — это игровое условие, а не комбинация
тайлов внутри руки, но это игровое условие является яку, которое стоит 1 хан.

Риичи можно объявить при условии темпая на закрытой руке. Для этого игрок на своем ходу громко говорит
"Риичи", сбрасывает в дискард лишний тайл, поворачивая его боком, и делает ставку в размере 1000 очков.
Ставка кладется на стол перед дискардом игрока. После объявления риичи игрок **не вправе модифицировать руку**.
Это плата за получение возможности победить. Другими словами, теперь каждый взятый со стены тайл обязан быть
снесен в дискард, если он не дает победы, даже если этот тайл является очевидно выигрышным кому-либо другому.
Риичи не может быть объявлен позднее, чем за 4 тайла до конца стены. Запомнить можно так: после объявления
риичи у игрока должна быть возможность взять тайл со стены в случае, если ход в дальнейшем не будет прерван
никакими объявлениями.

<Alert color="green">
  Последовательность объявления риичи фиксирована:
  — Сначала громко объявить
  — Затем сбросить тайл боком в дискард
  — И только после этого положить ставку в 1000 очков.

  Это может быть важно, поскольку в случае победы с тайла, которым объявляется риичи, ставка риичи не считается
  сделанной и соответственно не уходит победившему.
</Alert>

### Дора
В игре существуют так называемые тайлы **до́ра** — бонусные тайлы, каждый из которых увеличивает стоимость
руки на 1 хан. **Дора не дает яку**, то есть только на дорах победить нельзя. При начальном разборе стены
в мертвой стене переворачивается единственный верхний тайл, третий от конца. Этот тайл играет роль **указателя доры**.
Дорой является тайл, следующий по порядку за тем тайлом, который указан в индикаторе. Например, если в
индикаторе 5 <abbr title="символов">ман</abbr>, то шестерка ман будет дорой. Последовательности замкнуты:
- 1 → 2 → 3 → 4 → 5 → 6 → 7 → 8 → 9 → 1 (внутри каждой масти)
- <abbr title="красный дракон">чун</abbr> → <abbr title="белый дракон">хаку</abbr> →
  <abbr title="зеленый дракон">хацу</abbr> → <abbr title="красный дракон">чун</abbr>
- восток → юг → запад → север → восток

Каждый раз при взятии кана, открывается новый указатель доры. Таким образом, дор в игре становится не 4, а 8.
Больше канов — больше дор. Дора, полученная открытием нового указателя после кана, называется **кандорой**.

В случае выгрыша с яку риичи, помимо верхних указателей доры, нужно посмотреть еще и нижние указатели — все тайлы,
которые лежат непосредственно под открытыми верхними указателями доры. Доры, полученные открытием нижнего указателя,
называются **урадо́рами**, либо если нижний указатель находится под указателем кандоры — **кан-урадо́рами**.
Таким образом, за каждый кан в игру добавляется четыре кандоры и четыре кан-урадоры.

<Alert color="green">
  В некоторых правилах стола предусмотрена замена пятерок мастей на аналогичные пятерки, но окрашенные в ярко-красный
  цвет. Эти красные пятерки называются **акадо́рами** и являются дорами сами по себе независимо от того, какой тайл
  лежит в указателе доры. Если в указателе лежит четверка какой-либо масти, то акадора этой масти одновременно является
  и дорой, и акадорой, поэтому увеличивает стоимость руки не на 1, а на 2 хан.
</Alert>

### Фуритен

В японском маджонге существует правило **фурите́н**, которое гласит, что игрок лишается возможности победить
по рон, если любой из тайлов, дополняющих его руку до выигрышной формы, находится в его дискарде. Поэтому
это правило также иногда называют "Правилом упущенного дискарда". Победа при фуритене допустима только со стены,
т.е. по цумо. Правило фуритен дает важную составляющую игры, а именно — возможность игры в защиту. Если
какой-то игрок объявил риичи, можно смело сбрасывать любые тайлы из тех, что лежат у него в дискарде, если
таковые конечно имеются в нашей руке. Выиграть с них он не сможет, а в случае попытки объявить победу при
фуритене — это будет засчитано как неправильное объявление победы с последующим штрафом.

<Alert color="green">
  Важный момент заключается в том, что тайл, дающий фуритен, не обязательно должен давать яку. Если в дискарде лежит
  тайл, дополняющий руку до четырех сетов и пары — победной формы — но при этом не дающий очков, это все еще фуритен!
</Alert>

Также именно правилом фуритен объясняется необходимость класть взятые тайлы в открытые сеты так, чтобы было понятно,
с каких игроков они были взяты. Следует относиться к этому крайне внимательно, иначе можно получить штраф из-за
ошибки другого игрока.

### Временный фуритен

Также существует так называемое правило **вре́менного фуритена**, которое запрещает победу по рон, если на
этом же круге была возможность объявить победу, но игрок ей не воспользовался. Например, если мы побеждаем с 2 и 5
пин, правый игрок в свой ход сбросил 2 пин, но мы не объявили победу, игроки напротив и слева могут свободно сбрасывать
2 и 5 пин **на этом круге**, поскольку мы не сможем с них победить из-за временного фуритена. Это дает важную тактику
защиты — если сбрасывать тайл, который только что был сброшен игроком слева, с этого тайла не сможет победить
никто в силу фуритена и временного фуритена.

Временный фуритен длится до момента, когда **игрок может формально сменить ожидание**, то есть до взятия игроком тайла
со стены. В принципе, игрок может и не менять ожидание, но ключевое слово здесь — **формально**, и вот почему:
в случае, если игрок обявил риичи, он не может менять свое ожидание, даже формально. В этом случае пропущенный
победный тайл дает ему временный фуритен, который длится до конца раздачи, поскольку игрок не может сменить ожидание
даже формально. Разумеется, в случае "вечного" временного фуритена возможна победа по цумо.

## Подсчет очков

Подсчет очков сводится к подсчету количества хан, которые даются за яку и доры, и к подсчету миниочков **фу**, которые
даются за выполнение некоторых условий в руке. Для подсчета количества хан следует посмотреть список яку, просуммировать
количество хан по всем найденным яку и добавить к ним количество хан по дорам — по одному за каждую дору, акадору, кандору,
урадору, кан-урадору. Миниочки фу подсчитываются по следующим правилам:
- Базовое число фу: 20. Меньше этого не может быть.
- Победа по цумо: +2 фу. Не учитываются при пинфу и риншан кайхо.
- Победа по рон при закрытой руке: +10 фу.
- Ожидание на победу в <abbr title="ожидание в пару">танки</abbr>,
  <abbr title="внутреннее ожидание в чи, например 3-5">канчан</abbr> или
  <abbr title="краевое ожидание в чи, например 1-2">пенчан</abbr>: +2 фу.
- Пара, состоящая из якухайных тайлов: +2 фу. Если пара состоит из ветра раунда, одновременно являющегося ветром места: +4 фу.
- За пон или кан — согласно таблице:

<Table>
  <thead>
  <tr>
    <th >Тип</th>
    <th >Открытый</th>
    <th >Закрытый</th>
  </tr>
  </thead>
  <tbody>
  <tr>
    <td>Пон <abbr title="тайлы мастей от 2 до 8">простых</abbr> тайлов</td>
    <td>+2 фу</td>
    <td>+4 фу</td>
  </tr>
  <tr>
    <td>Пон <abbr title="единицы и девятки мастей">терминальных</abbr> или <abbr title="ветра и драконы">благородных</abbr> тайлов</td>
    <td>+4 фу</td>
    <td>+8 фу</td>
  </tr>
  <tr>
    <td>Кан <abbr title="тайлы мастей от 2 до 8">простых</abbr> тайлов</td>
    <td>+8 фу</td>
    <td>+16 фу</td>
  </tr>
  <tr>
    <td>Кан <abbr title="единицы и девятки мастей">терминальных</abbr> или <abbr title="ветра и драконы">благородных</abbr> тайлов</td>
    <td>+16 фу</td>
    <td>+32 фу</td>
  </tr>
  </tbody>
</Table>

В случае ожидания в <abbr title="ожидание в два пона, состоящее из двух пар, каждая их которых может стать коцу">сянпон</abbr>
при победе по рон, полученный пон считается **открытым** и миниочки для него считаются соответственно. В том же случае,
но при победе по цумо, полученный пон считается **закрытым**. После подсчета миниочки фу округляются вверх до десятков.
После этого требуется посмотреть в <a target='_blank' href='https://furiten.riichimahjong.org/httpsfuriten.ru/public/cheatsheet-v2.pdf'>таблицу выплат</a>,
где в зависимости от количества хан и фу определить требуемые выплаты.

Существуют также два особых яку, которые не состоят из четырех сетов и пары:
- **Кокушимусо** — комбинация из 13ти тайлов, по одной единице и девятке каждой масти, по одному ветру и дракону +
  пара к любому из 13ти тайлов. Кокушимусо стоит **якуман**.
- **Чиитойцу** — комбинация из семи пар любых тайлов. Чиитойцу стоит 2 хан и имеет **фиксированное количество фу, равное 25**.

<Alert color="green">
  В случае множества комбинаций в руке, следует помнить о правиле подсчета яку, которое не допускает использовать
  одни и те же тайлы в разных сетах. Пример:
  <Hand>
    <ClosedPart>
      <TileSet>
        <Tile value={TileValue.Pin4} />
        <Tile value={TileValue.Pin5} />
        <Tile value={TileValue.Pin6} />
      </TileSet>
      <TileSet>
        <Tile value={TileValue.Sou4} />
        <Tile value={TileValue.Sou4} />
        <Tile value={TileValue.Sou5} />
        <Tile value={TileValue.Sou6} />
        <Tile value={TileValue.Sou6} />
        <Tile value={TileValue.Sou7} />
        <Tile value={TileValue.Sou7} />
      </TileSet>
      <TileSet>
        <Tile value={TileValue.Man4} />
        <Tile value={TileValue.Man5} />
        <Tile value={TileValue.Man6} />
      </TileSet>
    </ClosedPart>
  </Hand>
  В примере выше можно разглядеть комбинацию "пинфу" с ожиданием в две стороны на 5 и 8 соу. Но также здесь можно найти
  и комбинацию "саншоку" — три одинаковых по значению чи разных мастей. В данном случае эти комбинации являются
  несовместимыми, поскольку в случае пинфу мы должны считать парой две четверки, но в этом случае у нас не получается
  ни одного сета 456 соу, поскольку четверки уже использованы в паре.
</Alert>

## Нарушения правил
Ну и наконец ложка дегтя: существуют определенные штрафы за нарушения правил, независимо от того, было ли нарушение
преднамеренным или случайным.
- **Чомбо** — штраф, выплачиваемый игроком за грубое нарушение правил, не позволяющее продолжить
  сдачу. При чомбо дилер остается на месте, риичи депозиты возвращаются, хонба не добавляется, т.е. ситуация должна
  вернуться на состояние в начале сдачи.
- **Мертвая рука** — состояние игрока, при котором он не имеет права делать никаких объявлений, при ничьей он считается
  нотен. Если игрок с мертвой рукой объявляет пон, чи, кан или победу, то он наказывается чомбо.

В клубных играх чомбо обычно выплачивается как обратный манган — т.е. нарушивший правила игрок выплачивает 4000 дилеру
и по 2000 остальным. Если проштрафился дилер, он платит всем по 4000. В турнирных играх как правило применяется
штраф в -20000 очков после окончания игры, т.е. никаких выплат при чомбо не происходит.

Следующие действия наказываются чомбо:
- **<abbr title="в случае отсутствия ожидающей руки (темпая)">Нотен</abbr> риичи**, назначается в случае ничьей.
- **Ошибочное объявление победы**, применяется в случае объявления победы и полного открытия не имеющей выигрыша руки. Ошибочное объявление победы имеет больший приоритет, чем объявления открытых сетов, но меньший, чем правильное объявление победы, т.е. если на один и тот же тайл было сделано два объявления победы, и одно из них было ошибочным, засчитывается второе объявление и к первому штраф чомбо **не применяется**.
- **Объявление кана, меняющего ожидание при риичи**, назначается в случае ничьей или победы игрока объявившего такой кан.
- Если по вине игрока текущую раздачу **невозможно продолжать**.

Следующие ситуации караются мертвой рукой:
- Взятие тайла из стены вне очереди, пропуск хода или неправильное взятие.
- Ошибочное объявление чи, пона, кана (в этом случае взятый тайл возвращается обратно в дискард), либо объявление чи не в свой ход.
- Неправильное количество тайлов в руке (более или менее 13 тайлов + 1 за каждый объявленный кан).
- Подсматривание тайлов из мертвой стены или рук других игроков.

<Alert color="green">
  На турнире штрафы чомбо обычно назначаются только при участии судьи. В случае любых спорных ситуаций относительно
  назначения мертвых рук следует также вызывать судью.
</Alert>

## Полезные ссылки

Дальнейшее изучение правил можно продолжить по следующим ссылкам:
- <a href='http://tesuji-club.ru/stati-i-perevodi' target='_blank'>Статьи и переводы</a>
- <a href='https://vk.com/anchan_no_maajan' target='_blank'>Группа с переводами книг</a>
- <a href='https://t.me/riichi_en_ru_books' target='_blank'>Риичи-библиотека</a>
- <a href='https://t.me/riichi_mahjong' target='_blank'>Новости сообщества риичи</a>

Пообщаться с другими игроками можно здесь:
- <a href='https://t.me/tenhou' target='_blank'>Русскоязычный чат игроков в риичи</a>
- <a href='https://t.me/newteachingcommunity' target='_blank'>Конференция для развития в риичи</a>
- <a href='https://mahjong.click/ru' target='_blank'>Риичи портал со ссылками на локальные клубы, грядущие турниры и не только</a>
